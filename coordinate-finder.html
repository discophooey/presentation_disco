<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Coordinate Finder - Presentation Disco</title>
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; background: #0a0a0a; color: #e0e0e0; min-height: 100vh; padding: 24px; }

.header { max-width: 1000px; margin: 0 auto 24px; display: flex; align-items: center; gap: 16px; }
.back-btn { background: #2a2a2a; border: 1px solid #3a3a3a; color: #888; padding: 8px 12px; border-radius: 6px; cursor: pointer; font-size: 13px; text-decoration: none; }
.back-btn:hover { background: #3a3a3a; color: #fff; }
h1 { color: #4a9eff; font-size: 24px; }
.subtitle { color: #666; font-size: 13px; margin-left: auto; }

.container { max-width: 1000px; margin: 0 auto; display: grid; grid-template-columns: 1fr 280px; gap: 20px; }

#map { width: 100%; height: 450px; border-radius: 12px; border: 1px solid #2a2a2a; }

.input-row { display: grid; grid-template-columns: 1fr 1fr auto; gap: 12px; margin-top: 16px; }
.input-field label { color: #666; font-size: 11px; display: block; margin-bottom: 6px; text-transform: uppercase; }
.input-field input { width: 100%; background: #1a1a1a; border: 1px solid #2a2a2a; color: #fff; padding: 10px 12px; border-radius: 6px; font-size: 16px; font-family: monospace; }
.input-field input:focus { outline: none; border-color: #4a9eff; }
.go-btn { background: #2a2a2a; border: 1px solid #3a3a3a; color: #888; padding: 10px 16px; border-radius: 6px; cursor: pointer; font-size: 14px; margin-top: 22px; }
.go-btn:hover { background: #3a3a3a; color: #fff; }

.sidebar { display: flex; flex-direction: column; gap: 16px; }

.panel { background: #1a1a1a; border: 1px solid #2a2a2a; border-radius: 10px; padding: 16px; }
.panel h3 { color: #fff; font-size: 14px; margin-bottom: 12px; }

.copy-btn { width: 100%; padding: 12px; border: none; border-radius: 6px; cursor: pointer; font-size: 13px; margin-bottom: 8px; font-weight: 600; transition: all 0.2s; }
.copy-btn.primary { background: #4a9eff; color: #000; }
.copy-btn.primary:hover { background: #357abd; }
.copy-btn.primary.copied { background: #2ecc71; }
.copy-btn.secondary { background: #2a2a2a; border: 1px solid #3a3a3a; color: #888; text-align: left; font-family: monospace; font-weight: normal; }
.copy-btn.secondary:hover { background: #3a3a3a; color: #fff; }
.copy-btn.secondary.copied { background: #2ecc71; color: #000; }

.panel-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px; }
.panel-header h3 { margin: 0; }
.save-btn { background: transparent; border: 1px solid #3a3a3a; color: #888; padding: 4px 10px; border-radius: 4px; cursor: pointer; font-size: 11px; }
.save-btn:hover { background: #2a2a2a; color: #fff; }

.locations-list { display: flex; flex-direction: column; gap: 6px; max-height: 200px; overflow-y: auto; }
.location-item { background: #2a2a2a; padding: 8px 12px; border-radius: 6px; cursor: pointer; display: flex; justify-content: space-between; align-items: center; }
.location-item:hover { background: #3a3a3a; }
.location-name { color: #fff; font-size: 13px; }
.location-coords { color: #666; font-size: 11px; }
.location-delete { background: transparent; border: none; color: #555; cursor: pointer; font-size: 14px; padding: 0 4px; }
.location-delete:hover { color: #e74c3c; }

.globe-preview { text-align: center; }
.globe-label { color: #666; font-size: 11px; margin-bottom: 8px; text-transform: uppercase; }
.globe { width: 80px; height: 80px; margin: 0 auto; background: linear-gradient(135deg, #1e90ff, #0a4a7a); border-radius: 50%; position: relative; box-shadow: 0 0 30px rgba(30,144,255,0.3); }
.globe-marker { position: absolute; width: 8px; height: 8px; background: #e74c3c; border-radius: 50%; box-shadow: 0 0 10px #e74c3c; transform: translate(-50%, -50%); }

.empty-locations { color: #555; font-size: 13px; text-align: center; padding: 20px; }

/* Leaflet overrides for dark theme */
.leaflet-container { background: #1a1a1a; }
.leaflet-control-zoom a { background: #2a2a2a !important; color: #888 !important; border-color: #3a3a3a !important; }
.leaflet-control-zoom a:hover { background: #3a3a3a !important; color: #fff !important; }
.leaflet-control-attribution { background: rgba(26,26,26,0.8) !important; color: #666 !important; }
.leaflet-control-attribution a { color: #4a9eff !important; }
</style>
</head>
<body>

<div class="header">
    <a href="index.html" class="back-btn">‚Üê Hub</a>
    <h1>Coordinate Finder</h1>
    <span class="subtitle">Click map or drag marker to get coordinates</span>
</div>

<div class="container">
    <div>
        <div id="map"></div>
        <div class="input-row">
            <div class="input-field">
                <label>Latitude</label>
                <input type="number" id="latInput" value="40.7128" step="0.0001" onchange="updateFromInput()" />
            </div>
            <div class="input-field">
                <label>Longitude</label>
                <input type="number" id="lngInput" value="-74.0060" step="0.0001" onchange="updateFromInput()" />
            </div>
            <button class="go-btn" onclick="goToCoords()">Go ‚Üí</button>
        </div>
    </div>

    <div class="sidebar">
        <div class="panel">
            <h3>Copy Coordinates</h3>
            <button class="copy-btn primary" id="copyBothBtn" onclick="copyBoth()">
                üìã <span id="coordsDisplay">40.7128, -74.0060</span>
            </button>
            <button class="copy-btn secondary" id="copyGlobeBtn" onclick="copyForGlobe()">
                { lat, lng, label }
            </button>
        </div>

        <div class="panel" style="flex: 1;">
            <div class="panel-header">
                <h3>Saved Locations</h3>
                <button class="save-btn" onclick="saveLocation()">+ Save</button>
            </div>
            <div class="locations-list" id="locationsList"></div>
        </div>

        <div class="panel globe-preview">
            <div class="globe-label">Globe Preview</div>
            <div class="globe">
                <div class="globe-marker" id="globeMarker"></div>
            </div>
        </div>
    </div>
</div>

<script>
let lat = 40.7128;
let lng = -74.0060;
let map, marker;
let savedLocations = JSON.parse(localStorage.getItem('disco_coords_saved') || '[]');

// Initialize map
function initMap() {
    map = L.map('map').setView([lat, lng], 4);
    
    // Dark tile layer
    L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', {
        attribution: '¬©OpenStreetMap, ¬©CartoDB',
        maxZoom: 19
    }).addTo(map);

    // Custom marker icon
    const markerIcon = L.divIcon({
        className: 'custom-marker',
        html: '<div style="width:20px;height:20px;background:#e74c3c;border:3px solid #fff;border-radius:50%;box-shadow:0 0 20px rgba(231,76,60,0.8);"></div>',
        iconSize: [20, 20],
        iconAnchor: [10, 10]
    });

    // Draggable marker
    marker = L.marker([lat, lng], { icon: markerIcon, draggable: true }).addTo(map);
    
    marker.on('dragend', function(e) {
        const pos = e.target.getLatLng();
        updateCoords(pos.lat, pos.lng);
    });

    // Click to place
    map.on('click', function(e) {
        marker.setLatLng(e.latlng);
        updateCoords(e.latlng.lat, e.latlng.lng);
    });
}

function updateCoords(newLat, newLng) {
    lat = parseFloat(newLat.toFixed(4));
    lng = parseFloat(newLng.toFixed(4));
    
    document.getElementById('latInput').value = lat;
    document.getElementById('lngInput').value = lng;
    document.getElementById('coordsDisplay').textContent = `${lat}, ${lng}`;
    
    // Update globe preview
    const markerEl = document.getElementById('globeMarker');
    markerEl.style.left = `${50 + (lng / 180) * 30}%`;
    markerEl.style.top = `${50 - (lat / 90) * 30}%`;
}

function updateFromInput() {
    lat = parseFloat(document.getElementById('latInput').value) || 0;
    lng = parseFloat(document.getElementById('lngInput').value) || 0;
    marker.setLatLng([lat, lng]);
    updateCoords(lat, lng);
}

function goToCoords() {
    map.setView([lat, lng], 8);
}

function copyBoth() {
    navigator.clipboard.writeText(`${lat}, ${lng}`);
    const btn = document.getElementById('copyBothBtn');
    btn.classList.add('copied');
    btn.innerHTML = '‚úì Copied!';
    setTimeout(() => {
        btn.classList.remove('copied');
        btn.innerHTML = `üìã <span id="coordsDisplay">${lat}, ${lng}</span>`;
    }, 1500);
}

function copyForGlobe() {
    const code = `{ lat: ${lat}, lng: ${lng}, label: "Location" }`;
    navigator.clipboard.writeText(code);
    const btn = document.getElementById('copyGlobeBtn');
    btn.classList.add('copied');
    btn.textContent = '‚úì Copied!';
    setTimeout(() => {
        btn.classList.remove('copied');
        btn.textContent = '{ lat, lng, label }';
    }, 1500);
}

function saveLocation() {
    const name = prompt('Name this location:', 'New Location');
    if (name) {
        savedLocations.push({ name, lat, lng });
        localStorage.setItem('disco_coords_saved', JSON.stringify(savedLocations));
        renderLocations();
    }
}

function loadLocation(index) {
    const loc = savedLocations[index];
    lat = loc.lat;
    lng = loc.lng;
    marker.setLatLng([lat, lng]);
    map.setView([lat, lng], 6);
    updateCoords(lat, lng);
}

function deleteLocation(index, e) {
    e.stopPropagation();
    savedLocations.splice(index, 1);
    localStorage.setItem('disco_coords_saved', JSON.stringify(savedLocations));
    renderLocations();
}

function renderLocations() {
    const container = document.getElementById('locationsList');
    if (savedLocations.length === 0) {
        container.innerHTML = '<div class="empty-locations">No saved locations</div>';
        return;
    }
    container.innerHTML = savedLocations.map((loc, i) => `
        <div class="location-item" onclick="loadLocation(${i})">
            <div>
                <div class="location-name">${loc.name}</div>
                <div class="location-coords">${loc.lat.toFixed(2)}, ${loc.lng.toFixed(2)}</div>
            </div>
            <button class="location-delete" onclick="deleteLocation(${i}, event)">√ó</button>
        </div>
    `).join('');
}

// Init
initMap();
renderLocations();
updateCoords(lat, lng);
</script>
</body>
</html>
