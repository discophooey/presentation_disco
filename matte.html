<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Scrolltastic Matte</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Roboto:wght@400;700;900&display=swap');

* { margin: 0; padding: 0; box-sizing: border-box; }
body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: #111; color: #fff; }

/* Grid Layout */
.app { display: grid; grid-template-columns: 400px 1fr; height: calc(100vh - 45px); margin-top: 45px; }
.controls { background: #111; padding: 20px; overflow-y: auto; border-right: 1px solid #222; }

/* Collapsible Sections */
.section { margin-bottom: 16px; background: #1a1a1a; border-radius: 8px; overflow: hidden; }
.section-header { padding: 12px 16px; background: #222; cursor: pointer; display: flex; justify-content: space-between; align-items: center; font-weight: 500; }
.section-header:hover { background: #2a2a2a; }
.section-content { padding: 16px; display: none; }
.section.open .section-content { display: block; }
.section-toggle { transition: transform 0.2s; }
.section.open .section-toggle { transform: rotate(180deg); }

/* Form Elements */
label { display: block; margin-bottom: 6px; font-size: 12px; color: #888; }
input[type="text"], input[type="number"], select, textarea { width: 100%; padding: 8px 12px; background: #222; border: 1px solid #333; border-radius: 6px; color: #fff; font-size: 13px; margin-bottom: 12px; }
textarea { min-height: 60px; resize: vertical; }
input[type="color"] { width: 50px; height: 32px; padding: 2px; background: #222; border: 1px solid #333; border-radius: 4px; cursor: pointer; }
input[type="range"] { width: 100%; margin: 8px 0; }

.row { display: flex; gap: 10px; align-items: center; margin-bottom: 12px; }
.row input[type="number"] { width: 70px; margin-bottom: 0; }
.row input[type="range"] { flex: 1; margin: 0; }

/* Toggle Buttons */
.toggle-group { display: flex; gap: 8px; margin-bottom: 12px; }
.toggle-btn { flex: 1; padding: 8px 12px; background: #222; border: 1px solid #333; border-radius: 6px; color: #888; cursor: pointer; font-size: 12px; text-align: center; transition: all 0.2s; }
.toggle-btn:hover { background: #2a2a2a; }
.toggle-btn.active { background: #4a9eff; border-color: #4a9eff; color: #fff; }

/* Position Grid */
.position-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 4px; margin-bottom: 12px; }
.pos-btn { padding: 8px; background: #222; border: 1px solid #333; border-radius: 4px; color: #666; cursor: pointer; text-align: center; font-size: 14px; transition: all 0.2s; }
.pos-btn:hover { background: #2a2a2a; color: #fff; }
.pos-btn.active { background: #4a9eff; border-color: #4a9eff; color: #fff; }

/* Buttons */
.btn { padding: 10px 16px; border: none; border-radius: 6px; cursor: pointer; font-size: 13px; font-weight: 500; transition: all 0.2s; }
.btn-primary { background: #4a9eff; color: #fff; width: 100%; margin-bottom: 8px; }
.btn-primary:hover { background: #3a8eef; }
.btn-secondary { background: #333; color: #fff; }
.btn-secondary:hover { background: #444; }
.btn-danger { background: #e74c3c; color: #fff; }
.btn-danger:hover { background: #c0392b; }

/* Preview Area */
.preview-area { background: #000; display: flex; flex-direction: column; overflow: hidden; }
.preview-header { padding: 10px 16px; background: #111; border-bottom: 1px solid #222; display: flex; justify-content: space-between; font-size: 11px; color: #666; }
.preview-scroll { flex: 1; overflow-y: auto; }
.preview-container { position: relative; }
.preview-stage { position: sticky; top: 0; height: 100vh; display: flex; align-items: center; justify-content: center; overflow: hidden; background: #000; }

/* Matte Container */
.matte-wrap { position: relative; width: 90%; min-height: 500px; overflow: hidden; border-radius: 12px; }
.matte-wrap.fit { width: auto; height: auto; }
.matte-wrap.contain { width: 98%; height: 90vh; min-height: auto; }
.matte-wrap.fill { width: 100%; min-height: 70vh; }

/* Background Layer */
.matte-bg { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background-size: cover; background-position: center; z-index: 1; }

/* Solid Surround Layer */
.matte-surround { position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 2; opacity: 0; }

/* Text Matte Layer */
.matte-text { position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 3; display: flex; padding: 20px; box-sizing: border-box; }
.matte-text.pos-center { align-items: center; justify-content: center; }
.matte-text.pos-top { align-items: flex-start; justify-content: center; }
.matte-text.pos-bottom { align-items: flex-end; justify-content: center; }
.matte-text.pos-left { align-items: center; justify-content: flex-start; }
.matte-text.pos-right { align-items: center; justify-content: flex-end; }
.matte-text.pos-top-left { align-items: flex-start; justify-content: flex-start; }
.matte-text.pos-top-right { align-items: flex-start; justify-content: flex-end; }
.matte-text.pos-bottom-left { align-items: flex-end; justify-content: flex-start; }
.matte-text.pos-bottom-right { align-items: flex-end; justify-content: flex-end; }

/* Text content wrapper */
.matte-text-inner { font-family: 'AP', 'Roboto', sans-serif; font-weight: 700; white-space: nowrap; background-clip: text; -webkit-background-clip: text; color: transparent; background-size: cover; background-position: center; }
.matte-fade { opacity: 0; }

/* Letter animation */
.matte-letter { display: inline-block; opacity: 0; background-clip: text; -webkit-background-clip: text; color: transparent; }

/* Image Matte */
.matte-image { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); z-index: 3; max-width: 80%; max-height: 80%; opacity: 0; }

/* Modal */
.modal { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.9); z-index: 1000; align-items: center; justify-content: center; }
.modal.active { display: flex; }
.modal-content { background: #111; border-radius: 12px; padding: 24px; width: 90%; max-width: 800px; max-height: 85vh; overflow: auto; }
.modal-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px; }
.modal-close { background: none; border: none; color: #888; font-size: 24px; cursor: pointer; }
textarea#exportCode { width: 100%; height: 300px; background: #1a1a1a; border: 1px solid #333; border-radius: 8px; padding: 12px; color: #4a9eff; font-family: monospace; font-size: 12px; resize: vertical; }
</style>
</head>
<body>
<div id="disco-nav" style="position:fixed;top:0;left:0;right:0;z-index:99999;background:#111;border-bottom:1px solid #2a2a2a;display:flex;overflow-x:auto;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',sans-serif;">
<a href="index.html" style="padding:8px 12px;color:#4a9eff;text-decoration:none;font-size:12px;font-weight:600;white-space:nowrap;">‚Üê Hub</a>
<a href="before-after.html" data-module="before-after" style="padding:8px 10px;color:#888;text-decoration:none;font-size:10px;white-space:nowrap;display:flex;align-items:center;gap:4px;">Before/After<span class="dot"></span></a>
<a href="card-stack.html" data-module="card-stack" style="padding:8px 10px;color:#888;text-decoration:none;font-size:10px;white-space:nowrap;display:flex;align-items:center;gap:4px;">Card Stack<span class="dot"></span></a>
<a href="chart.html" data-module="chart" style="padding:8px 10px;color:#888;text-decoration:none;font-size:10px;white-space:nowrap;display:flex;align-items:center;gap:4px;">Chart<span class="dot"></span></a>
<a href="collage.html" data-module="collage" style="padding:8px 10px;color:#888;text-decoration:none;font-size:10px;white-space:nowrap;display:flex;align-items:center;gap:4px;">Collage<span class="dot"></span></a>
<a href="doc-module.html" data-module="doc-module" style="padding:8px 10px;color:#888;text-decoration:none;font-size:10px;white-space:nowrap;display:flex;align-items:center;gap:4px;">Doc Module<span class="dot"></span></a>
<a href="gallery.html" data-module="gallery" style="padding:8px 10px;color:#888;text-decoration:none;font-size:10px;white-space:nowrap;display:flex;align-items:center;gap:4px;">Gallery<span class="dot"></span></a>
<a href="globe.html" data-module="globe" style="padding:8px 10px;color:#888;text-decoration:none;font-size:10px;white-space:nowrap;display:flex;align-items:center;gap:4px;">Globe<span class="dot"></span></a>
<a href="hotspots.html" data-module="hotspots" style="padding:8px 10px;color:#888;text-decoration:none;font-size:10px;white-space:nowrap;display:flex;align-items:center;gap:4px;">Hotspots<span class="dot"></span></a>
<a href="layers.html" data-module="layers" style="padding:8px 10px;color:#888;text-decoration:none;font-size:10px;white-space:nowrap;display:flex;align-items:center;gap:4px;">Layers<span class="dot"></span></a>
<a href="matte.html" data-module="matte" style="padding:8px 10px;color:#888;text-decoration:none;font-size:10px;white-space:nowrap;display:flex;align-items:center;gap:4px;">Matte<span class="dot"></span></a>
<a href="pull-quote.html" data-module="pull-quote" style="padding:8px 10px;color:#888;text-decoration:none;font-size:10px;white-space:nowrap;display:flex;align-items:center;gap:4px;">Pull Quote<span class="dot"></span></a>
<a href="single-image.html" data-module="single-image" style="padding:8px 10px;color:#888;text-decoration:none;font-size:10px;white-space:nowrap;display:flex;align-items:center;gap:4px;">Single Image<span class="dot"></span></a>
<a href="stat-counter.html" data-module="stat-counter" style="padding:8px 10px;color:#888;text-decoration:none;font-size:10px;white-space:nowrap;display:flex;align-items:center;gap:4px;">Stat Counter<span class="dot"></span></a>
<a href="timeline.html" data-module="timeline" style="padding:8px 10px;color:#888;text-decoration:none;font-size:10px;white-space:nowrap;display:flex;align-items:center;gap:4px;">Timeline<span class="dot"></span></a>
<a href="video.html" data-module="video" style="padding:8px 10px;color:#888;text-decoration:none;font-size:10px;white-space:nowrap;display:flex;align-items:center;gap:4px;">Video<span class="dot"></span></a>
<a href="zoom-detail.html" data-module="zoom-detail" style="padding:8px 10px;color:#888;text-decoration:none;font-size:10px;white-space:nowrap;display:flex;align-items:center;gap:4px;">Zoom Detail<span class="dot"></span></a>
<a href="text-scroll.html" data-module="text-scroll" style="padding:8px 10px;color:#888;text-decoration:none;font-size:10px;white-space:nowrap;display:flex;align-items:center;gap:4px;">Text Scroll<span class="dot"></span></a>
<a href="chapter-marker.html" data-module="chapter-marker" style="padding:8px 10px;color:#888;text-decoration:none;font-size:10px;white-space:nowrap;display:flex;align-items:center;gap:4px;">Chapter Marker<span class="dot"></span></a>
<a href="key-facts.html" data-module="key-facts" style="padding:8px 10px;color:#888;text-decoration:none;font-size:10px;white-space:nowrap;display:flex;align-items:center;gap:4px;">Key Facts<span class="dot"></span></a>
<a href="body-module.html" data-module="body-module" style="padding:8px 10px;color:#888;text-decoration:none;font-size:10px;white-space:nowrap;display:flex;align-items:center;gap:4px;">Body Module<span class="dot"></span></a>
<a href="stack-builder-clean.html" style="padding:8px 10px;color:#888;text-decoration:none;font-size:10px;white-space:nowrap;">Stack Builder</a>
</div>
<style>
#disco-nav a:hover{color:#fff!important;background:#1a1a1a;}
#disco-nav .dot{width:6px;height:6px;border-radius:50%;display:none;}
#disco-nav .dot.orange{display:inline-block;background:#f90;}
#disco-nav .dot.green{display:inline-block;background:#4a4;}
</style>
<script>
(function(){
  document.querySelectorAll('#disco-nav a[data-module]').forEach(function(a){
    var mod = a.getAttribute('data-module');
    var key = 'disco_' + mod;
    var dot = a.querySelector('.dot');
    if(!dot) return;
    var hasContent = localStorage.getItem(key);
    var fromPlanner = localStorage.getItem(key + '_from_planner');
    if(hasContent){
      if(fromPlanner === 'true'){
        dot.className = 'dot orange';
      } else {
        dot.className = 'dot green';
      }
    }
  });
  var path = location.pathname.split('/').pop() || 'index.html';
  document.querySelectorAll('#disco-nav a').forEach(function(a){
    if(a.getAttribute('href') === path){
      a.style.color = '#4a9eff';
      a.style.borderBottom = '2px solid #4a9eff';
    }
  });
})();
</script>

<script>
// Persistence for matte
(function() {
    var KEY = 'disco_matte';
    
    function saveState() {
        var state = { inputs: {}, config: config };
        
        document.querySelectorAll('input[id], select[id], textarea[id]').forEach(function(el) {
            if (el.type === 'checkbox') state.inputs[el.id] = el.checked;
            else if (el.type === 'file') return;
            else state.inputs[el.id] = el.value;
        });
        
        // Save toggle states
        state.textAnim = config.textAnim;
        state.textPosition = config.textPosition;
        state.sizing = config.sizing;
        
        try { localStorage.setItem(KEY, JSON.stringify(state)); localStorage.removeItem(KEY + '_from_planner'); } catch(e) {}
    }
    
    function loadState() {
        try {
            var saved = localStorage.getItem(KEY);
            if (!saved) return;
            var state = JSON.parse(saved);
            
            // Restore config
            if (state.config) {
                Object.keys(state.config).forEach(function(k) {
                    config[k] = state.config[k];
                });
            }
            
            // Restore inputs
            Object.keys(state.inputs || {}).forEach(function(id) {
                var el = document.getElementById(id);
                if (el) {
                    if (el.type === 'checkbox') el.checked = state.inputs[id];
                    else if (el.type === 'file') return;
                    else el.value = state.inputs[id];
                    
                    // Update value displays
                    var valEl = document.getElementById(id + 'Val');
                    if (valEl && el.type === 'range') {
                        var suffix = id.toLowerCase().includes('offset') ? 'px' : (id.toLowerCase().includes('duration') ? '%' : '');
                        valEl.textContent = el.value + suffix;
                    }
                }
            });
            
            // Restore toggle states
            if (state.textAnim) setTextAnim(state.textAnim);
            if (state.textPosition) setTextPosition(state.textPosition);
            if (state.sizing) setSizing(state.sizing);
            
            updatePreviewHeight();
            updatePreview();
        } catch(e) { console.warn('Load state error:', e); }
    }
    
    window.resetModule = function() {
        if (confirm('Reset all settings to defaults?')) {
            localStorage.removeItem(KEY);
            location.reload();
        }
    };
    
    document.addEventListener('change', saveState);
    document.addEventListener('input', saveState);
    
    setTimeout(loadState, 150);
})();
</script>
</body>
</html>
